type vendor_displayfeature, domain;
type vendor_displayfeature_exec, exec_type, vendor_file_type, file_type;
type vendor_hal_displayfeature_xiaomi_default, domain;
type vendor_hal_displayfeature_xiaomi_default_exec, exec_type, file_type, vendor_file_type;
type vendor_hal_displayfeature_xiaomi_hwservice, hwservice_manager_type, protected_service;
type vendor_sysfs_displayfeature, fs_type, sysfs_type;
type vendor_display_data_file, file_type, data_file_type;
type vendor_DisplayFeatureControl_service, vndservice_manager_type;
vendor_restricted_prop(vendor_displayfeature_prop)

allow vendor_displayfeature graphics_device:chr_file rw_file_perms;
allow vendor_hal_displayfeature_xiaomi_default graphics_device:chr_file rw_file_perms;
allow vendor_hal_displayfeature_xiaomi_default vendor_display_data_file:dir rw_file_perms;
allow vendor_hal_displayfeature_xiaomi_default vendor_display_data_file:file rw_file_perms;
allow vendor_hal_displayfeature_xiaomi_default vendor_displayfeature_device:chr_file rw_file_perms;

get_prop(vendor_displayfeature, vendor_displayfeature_prop)
get_prop(vendor_displayfeature, vendor_mtk_pq_prop)
set_prop(vendor_hal_displayfeature_xiaomi_default, vendor_displayfeature_prop)


allow vendor_hal_displayfeature_xiaomi_default binder_device:chr_file { append getattr ioctl lock map open read watch watch_reads write };
allow vendor_hal_displayfeature_xiaomi_default fwk_sensor_hwservice:hwservice_manager find;

allow vendor_hal_displayfeature_xiaomi_default hwbinder_device:chr_file { append getattr ioctl lock map open read watch watch_reads write };
allow vendor_hal_displayfeature_xiaomi_default hwservicemanager:binder { call transfer };
allow vendor_hal_displayfeature_xiaomi_default hwservicemanager_prop:file { getattr map open read };
allow vendor_hal_displayfeature_xiaomi_default sensors_device:chr_file { getattr ioctl lock map open read watch watch_reads };
allow vendor_hal_displayfeature_xiaomi_default storage_file:dir search;
allow vendor_hal_displayfeature_xiaomi_default sysfs_devinfo:file { getattr ioctl lock map open read watch watch_reads };
allow vendor_hal_displayfeature_xiaomi_default sysfs_gpu:file { getattr ioctl lock map open read watch watch_reads };
allow vendor_hal_displayfeature_xiaomi_default sysfs_leds:dir { getattr ioctl lock open read search watch watch_reads };
allow vendor_hal_displayfeature_xiaomi_default sysfs_leds:file { append getattr ioctl lock map open read watch watch_reads write };
allow vendor_hal_displayfeature_xiaomi_default system_file:dir { getattr ioctl lock open read search watch watch_reads };
allow vendor_hal_displayfeature_xiaomi_default system_server:binder call;
allow vendor_hal_displayfeature_xiaomi_default vendor_displayfeature_prop:file { getattr map open read };
allow vendor_hal_displayfeature_xiaomi_default vendor_displayfeature_prop:property_service set;
allow vendor_hal_displayfeature_xiaomi_default vendor_file:dir { getattr ioctl lock open read search watch watch_reads };
allow vendor_hal_displayfeature_xiaomi_default vendor_file:file { execute getattr map open read };
allow vendor_hal_displayfeature_xiaomi_default vendor_hal_displayfeature_xiaomi_default:dir { getattr ioctl lock open read search watch watch_reads };
allow vendor_hal_displayfeature_xiaomi_default vendor_hal_displayfeature_xiaomi_default:fd use;
allow vendor_hal_displayfeature_xiaomi_default vendor_hal_displayfeature_xiaomi_default:fifo_file { append getattr ioctl lock map open read watch watch_reads write };
allow vendor_hal_displayfeature_xiaomi_default vendor_hal_displayfeature_xiaomi_default:file { append getattr ioctl lock map open read watch watch_reads write };
allow vendor_hal_displayfeature_xiaomi_default vendor_hal_displayfeature_xiaomi_default:lnk_file { getattr ioctl lock map open read watch watch_reads };
allow vendor_hal_displayfeature_xiaomi_default vendor_hal_displayfeature_xiaomi_default:lockdown confidentiality;
allow vendor_hal_displayfeature_xiaomi_default vendor_hal_displayfeature_xiaomi_default:process { fork getattr getcap getpgid getsched getsession setcap setpgid setrlimit setsched sigchld sigkill signal signull sigstop };

allow vendor_hal_displayfeature_xiaomi_default vendor_hal_displayfeature_xiaomi_default_exec:file { entrypoint execute getattr map open read };
allow vendor_hal_displayfeature_xiaomi_default vendor_sysfs_displayfeature:dir { getattr ioctl lock open read search watch watch_reads };
allow vendor_hal_displayfeature_xiaomi_default vendor_sysfs_displayfeature:file { append getattr ioctl lock map open read watch watch_reads write };
allow vendor_hal_displayfeature_xiaomi_server vendor_hal_displayfeature_xiaomi_client:binder transfer;
allow vendor_hal_displayfeature_xiaomi_server vendor_hal_displayfeature_xiaomi_hwservice:hwservice_manager { add find };

